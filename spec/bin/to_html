#!/usr/bin/env ruby
$LOAD_PATH.unshift File.join(File.dirname(__FILE__), '../..', 'lib')
require 'polytexnic-core'

filename = ARGV.shift
polytex = File.open(filename) { |f| f.read }
html = Polytexnic::Core::Pipeline.new(polytex).to_html
outfile = File.join('tmp', File.basename(filename).sub('tex', 'html'))
output = <<EOF
<!DOCTYPE html>
<head>
<meta charset="UTF-8">
<style>
.tt { font-family: Courier; font-size: 90%; }
</style>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML">
  MathJax.Hub.Config({
    "HTML-CSS": {
      availableFonts: ["TeX"]
    }
  });
</script>
</head>
<body>
#{html}
</body>
EOF
File.open(outfile, 'w') { |f| f.write(output) }
puts "Wrote file #{outfile}"
